import gymnasium as gym

from stable_baselines3 import PPO

env = gym.make("CartPole-v1", render_mode=None)

model = PPO("MlpPolicy", env, verbose=1)
model.learn(total_timesteps=10_000)

vec_env = model.get_env()
obs = vec_env.reset()
for i in range(1000):
    action, _states = model.predict(obs, deterministic=True)
    obs, reward, done, info = vec_env.step(action)
    vec_env.render()
    # VecEnv resets automatically
    # if done:
    #   obs = env.reset()

env.close()


"""
tensor([ 0.8930,  0.8542,  0.9903, -0.8581, -0.9184,  0.9232, -0.9754,  0.8978,
         0.9504, -0.7075, -0.4209, -0.9095, -0.9757, -0.9246, -0.3170, -0.8447,
        -0.0778,  0.9627, -0.9106,  0.6468,  0.4173, -0.3433, -0.7901,  0.9751,
         0.9726,  0.0650, -0.9381,  0.9542, -0.9599,  0.9991, -0.8277, -0.3229,
        -0.9438, -0.5322, -0.9800, -0.5583,  0.9926, -0.1081,  0.8817,  0.7628,
        -0.9158,  0.9966,  0.9582,  0.9703, -0.3618,  0.2049,  0.2381, -0.9757,
        -0.4659, -0.2837,  0.4816, -0.7494,  0.9129,  0.9635,  0.9938,  0.9603,
         0.7978, -0.4322, -0.9674, -0.9710,  0.1392, -0.1572,  0.1341, -0.9124,
         0.9882,  0.8717,  0.8789,  0.2775,  0.0665,  0.6851, -0.6951,  0.9202,
        -0.2064,  0.9864,  0.9189,  0.9985, -0.8566, -0.9778, -0.9326, -0.9776,
         0.7174,  0.3367, -0.8901, -0.9371, -0.8665,  0.0391, -0.8409,  0.7358,
         0.6016,  0.8385,  0.9783, -0.9357, -0.9755, -0.9953,  0.8534,  0.9813,
         0.5767,  0.4621, -0.9528, -0.8209, -0.9949,  0.9364,  0.4692, -0.9932,
        -0.2244, -0.9859, -0.9827,  0.9186, -0.8875, -0.5604, -0.8907, -0.8896,
        -0.5583, -0.6323, -0.2252, -0.8493,  0.6390,  0.7904,  0.9854,  0.8379,
         0.3509,  0.9666,  0.8566, -0.4057, -0.9785, -0.9293, -0.5553, -0.7561,
         0.3872, -0.9666,  0.9263,  0.9930,  0.8704,  0.0292, -0.5743, -0.9971,
         0.3563, -0.3766,  0.9168,  0.9864, -0.9242, -0.2357, -0.4771,  0.7531,
        -0.9654,  0.9808,  0.4313,  0.9476,  0.5544, -0.9462,  0.2574,  0.8718,
        -0.2328, -0.8947,  0.2646, -0.8157,  0.9963, -0.9593,  0.8664,  0.0302,
         0.9807, -0.8118, -0.8509,  0.6640,  0.6747, -0.1773, -0.4158, -0.9033,
        -0.8692,  0.6966, -0.9613,  0.9954, -0.3868,  0.8578, -0.9423, -0.7632,
         0.6504,  0.8740,  0.8810, -0.9230, -0.9763, -0.9910, -0.7771,  0.8973,
        -0.9243,  0.1997, -0.7205,  0.3699, -0.5991, -0.4356, -0.8581, -0.9771,
         0.3340,  0.8046,  0.9179, -0.3539,  0.9347,  0.8594, -0.9721,  0.5208,
         0.5504,  0.9351,  0.6225, -0.7411,  0.1030,  0.4869, -0.6573,  0.0608,
        -0.7287,  0.3681,  0.8630, -0.7569,  0.9957,  0.0254, -0.9637,  0.2352,
         0.1372,  0.9523, -0.6153,  0.5183,  0.9404,  0.7466,  0.0546,  0.1193,
         0.1861, -0.9152, -0.8215,  0.6092, -0.8096, -0.7653,  0.2027,  0.8622,
        -0.7570, -0.9490, -0.9651,  0.1425,  0.2015, -0.3108, -0.9297,  0.8519,
        -0.7956, -0.0366,  0.2952, -0.9406,  0.9127, -0.6608,  0.1326, -0.9650,
         0.8670, -0.9449, -0.9943, -0.4514, -0.1817, -0.6414, -0.0606, -0.0694],
       device='cuda:0')
"""